doctype html
html(lang="en")
  head
    meta(charset="UTF-8")
    meta(name="viewport", content="width=device-width, initial-scale=1")
    title Manager Dashboard
    link(rel="stylesheet", href="/CSS/dashboard.css")

  body
    // Navbar
    header.navbar
      .brand
        a(href="/")
          img(src="/Images/mayondo logo.png", alt="Company Logo")
        h2 Mayondo Wood And Furniture
      nav.nav-links
        .dropdown
          a(href="/saleslist") Sales  ▼
          .dropdown-content
            a(href="/managersales") online Sales
        a(href="/stafflist") Staff
        .dropdown
          a(href="/analytic") Reports ▼
          .dropdown-content
            a(href="/accounting") Accounting
            a(href="/dashboard") Manager
            a(href="/suppliers") Suppliers
        a(href="/stockreport") Stock
        if user
          a(href="#" onclick="showLogoutConfirmation()" class="btn-logout" style="background-color: red; color: white; padding: 8px 16px; border-radius: 4px; text-decoration: none; display: inline-block;") Logout

    // Logout Confirmation Modal
    #logoutModal.modal(style="display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5);")
      .modal-content(style="background-color: white; margin: 15% auto; padding: 20px; border-radius: 8px; width: 80%; max-width: 400px; box-shadow: 0 4px 8px rgba(0,0,0,0.2);")
        .modal-header(style="border-bottom: 1px solid #ddd; padding-bottom: 10px; margin-bottom: 15px;")
          h3(style="margin: 0; color: #d9534f;") Confirm Logout
        .modal-body(style="margin-bottom: 20px;")
          p#logoutMessage(style="margin: 0;") Are you sure you want to log out?
        .modal-footer(style="text-align: right;")
          button.btn.btn-danger(type="button", onclick="confirmLogout()") Logout
          button.btn.btn-secondary(type="button", onclick="closeLogoutModal()", style="margin-left: 10px;") Cancel

    style.
      .notification {
        padding: 10px;
        margin: 5px 0;
        border-radius: 4px;
        font-size: 14px;
      }
      .notification.low-stock {
        background-color: #fff3cd;
        color: #856404;
        border-left: 4px solid #ffc107;
      }
      .notification.order {
        background-color: #d1ecf1;
        color: #0c5460;
        border-left: 4px solid #17a2b8;
      }
      .notification.delivery {
        background-color: #d4edda;
        color: #155724;
        border-left: 4px solid #28a745;
      }
      .notification.top-seller {
        background-color: #f8d7da;
        color: #721c24;
        border-left: 4px solid #dc3545;
      }
      function showLogoutConfirmation() {
        document.getElementById('logoutModal').style.display = 'block';
      }

      function closeLogoutModal() {
        document.getElementById('logoutModal').style.display = 'none';
      }

      function confirmLogout() {
        // Redirect to logout route which will destroy session and redirect to index
        window.location.href = '/logout';
      }

      // Close modal when clicking outside of it
      window.onclick = function(event) {
        const modal = document.getElementById('logoutModal');
        if (event.target === modal) {
          modal.style.display = 'none';
        }
      }


    // Dashboard container
    .container
      // Cards
      .cards
        .card
          h3 Total Sales
          p#sales UGX #{totalSales.toLocaleString()}
        .card
          h3 Active Agents
          p#agents #{totalAgents}
        .card
          h3 Pending Deliveries
          p#deliveries #{pendingOrders}
        .card
          h3 Products in Stock
          p#stock #{totalStock}
        .card
          h3 Expenses
          p#expenses UGX #{totalExpenses.toLocaleString()}
        .card
          h3 Net Profit
          p#profit UGX #{netProfit.toLocaleString()}
        .card
          h3 Suppliers
          p#suppliers #{totalSuppliers}


      // Notifications
      .notifications
        h3 Recent Notifications
        if notifications && notifications.length
          each notification in notifications
            .notification(class=notification.type) #{notification.message}
        else
          .notification No notifications available

    // Footer
    footer
      
      .footer-bottom
        | © 2025 Your Company Name. All rights reserved.

