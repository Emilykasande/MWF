meta(charset="UTF-8")
meta(name="viewport", content="width=device-width,initial-scale=1")
title Record New Sale
link(rel="stylesheet", href="/CSS/sales.css")

header.navbar
  .brand
    a(href="index.html")
      img(src="/Images/mayondo logo.png", alt="Company Logo")
    h2 Mayondo Wood And Furniture
  nav.nav-links
    a(href="/sales") CRM
    a(href="analytics.html") Analytics
    .dropdown
      a(href="accounting.html") Accounting ‚ñº
      .dropdown-content
        a(href="reports.html") Reports
        a(href="expenses.html") Expenses
        a(href="cashflow.html") Cash Flow
    a(href="store.html") E-commerce
    .search-box
      input(type="text", placeholder="Search...")
      button Go

.container
  .flex-container(style="display: flex; gap: 20px; flex-wrap: wrap;")
    
    // Add Sale Form
    .card(style="flex: 1; min-width: 300px;")
      h2 Add New Sale
      form#salesForm(action="/sales", method="post")
        label Customer Name
        input(type="text", name="customername", placeholder="Customer Name" required, value=(formData && formData.customername) || '')
        
        label Product
        input(type="text", name="product" required, value=(formData && formData.product) || '')
        
        label Quantity
        input(type="number", name="quantity" required, value=(formData && formData.quantity) || '1')
        
        label Unit Price
        input(type="number", step="0.01", name="price" required, value=(formData && formData.price) || '0.00')
        
        label Transport Required?
        select(name="transport")
          option(value="no", selected=(formData && formData.transport === 'no')) No
          option(value="yes", selected=(formData && formData.transport === 'yes')) Yes (+5%)
        
        label Payment Type
        select(name="paymentMethod")
          option(value="cash", selected=(formData && formData.paymentMethod === 'cash')) Cash
          option(value="mobile", selected=(formData && formData.paymentMethod === 'mobile')) Mobile Money
          option(value="bank", selected=(formData && formData.paymentMethod === 'bank')) Bank Transfer
        
        label Date
        input(type="date", name="date", required, value=(formData && formData.date) || '')
        
        button(type="submit") Record Sale

    // Sale Receipt with Company Details
    .card(style="flex: 1; min-width: 300px; padding: 20px;")
      // Company Header
      h2(style="text-align: center; margin-bottom: 5px") Mayondo Wood & Furniture
      img(src="/Images/mayondo logo.png", alt="Company Logo", style="width: 80px; display: block; margin: 0 auto 10px auto;")
      p(style="text-align: center; margin: 0") P.O. Box 123, Kampala, Uganda
      p(style="text-align: center; margin: 0") üìû +256 123 456 789 | üìß info@mayondo.com
      hr(style="margin: 10px 0")
      
      h3(style="text-align: center; margin-bottom: 15px") Sale Receipt

      // Receipt Details
      #receiptDetails.receipt-box
      if receipt
        p Customer: #{receipt.customername}
        p Product: #{receipt.product}
        p Quantity: #{receipt.quantity}
        p Unit Price: #{receipt.price}
        p Total Price: #{receipt.total}
        p Transport: #{receipt.transport}
        - var agentName = (receipt.salesAgent && receipt.salesAgent.fullname) ? receipt.salesAgent.fullname : 'N/A'
        p Sales Agent: #{agentName}
        p Payment Type: #{receipt.paymentMethod}
        - var formattedDate = receipt.date ? new Date(receipt.date).toLocaleString("en-UG", { dateStyle: 'medium', timeStyle: 'short' }) : 'N/A'
        p Date: #{formattedDate}
        hr(style="margin: 10px 0")
        p(style="text-align: center; font-style: italic; margin-top: 10px") Thank you for visiting our shop! We look forward to serving you again soon.
        button(type="button", onclick="printReceipt()") üñ® Print Receipt
      else
        p No receipt available yet.
footer
  h3 Connect With Us
  .footer-links
    a(href="mailto:info@yourcompany.com") üìß Email
    a(href="tel:+1234567890") üìû Phone
    a(href="https://wa.me/1234567890", target="_blank") üí¨ WhatsApp
    a(href="https://facebook.com/yourpage", target="_blank") üìò Facebook
    a(href="https://instagram.com/yourpage", target="_blank") üì∏ Instagram
    a(href="https://twitter.com/yourpage", target="_blank") üê¶ Twitter
  .footer-bottom
    p ¬© 2025 Your Company Name. All rights reserved.

script.
  function printReceipt() {
    const receiptContent = document.getElementById("receiptDetails").innerHTML;
    const win = window.open("", "_blank", "width=600,height=400");
    win.document.write('<html><head><title>Receipt</title></head><body>');
    win.document.write(receiptContent);
    win.document.write('</body></html>');
    win.document.close();
    win.print();
  }


//- script(src="/Javascript/sales.js")
